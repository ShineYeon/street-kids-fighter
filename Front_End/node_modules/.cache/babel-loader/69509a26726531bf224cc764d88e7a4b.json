{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\User\\\\Desktop\\\\React-Board-master\\\\newvenv\\\\React-Board\\\\src\\\\pages\\\\Profile.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport { Redirect, withRouter } from \"react-router-dom\";\n\nclass Profile extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isUpdate: false,\n      nickname: \"\",\n      position: \"\",\n      subjects: \"\",\n      image: \"\",\n      new_image: null\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.fileChangeHandler = this.fileChangeHandler.bind(this);\n    this.updateClick = this.updateClick.bind(this);\n    this.getProfile = this.getProfile.bind(this);\n    this.updateProfile = this.updateProfile.bind(this);\n    this.getProfile();\n  }\n\n  fileChangeHandler(event) {\n    event.preventDefault();\n    const file = event.target.files[0];\n    this.setState({\n      new_image: file,\n      image: file[\"name\"]\n    });\n  }\n\n  updateClick(event) {\n    event.preventDefault();\n\n    if (this.state.isUpdate === true) {\n      this.updateProfile();\n    } else {\n      this.setState(prevState => ({\n        isUpdate: !prevState.isUpdate\n      }));\n    }\n  }\n\n  handleChange(event) {\n    const target = event.target;\n    this.setState({\n      [target.name]: target.value\n    });\n  }\n\n  updateProfile() {\n    const token = localStorage.getItem(\"token\");\n    console.log(\"[*] updateProfile\");\n    const formData = new FormData();\n    formData.append(\"image\", this.state.new_image);\n    formData.append(\"nickname\", this.state.nickname);\n    formData.append(\"position\", this.state.position);\n    formData.append(\"subjects\", this.state.subjects);\n    console.log(formData.entries());\n    axios.patch(\"http://localhost:8000/users/profile/\", formData, {\n      headers: {\n        \"content-type\": \"multipart/form-data\",\n        \"Authorization\": `Token ${token}`\n      }\n    }).then(response => {\n      if (response.status < 300) {\n        this.props.history.push(\"/\");\n      }\n    });\n  }\n\n  getProfile() {\n    const token = localStorage.getItem(\"token\");\n    console.log(\"[*] getProfile\");\n    axios.get(\"http://localhost:8000/users/profile/\", {\n      headers: {\n        \"Authorization\": `Token ${token}`\n      }\n    }).then(response => {\n      if (response.status < 300) {\n        this.setState({\n          nickname: response.data[\"nickname\"],\n          position: response.data[\"position\"],\n          subjects: response.data[\"subjects\"],\n          image: response.data[\"image\"]\n        });\n      }\n    });\n  }\n\n  render() {\n    const isLogin = this.props.isLogin;\n    const isUpdate = this.state.isUpdate;\n\n    if (isLogin === false) {\n      return /*#__PURE__*/_jsxDEV(Redirect, {\n        to: \"/login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 14\n      }, this);\n    }\n\n    if (isUpdate === false) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container mcentered\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profile-img\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-img\",\n            children: /*#__PURE__*/_jsxDEV(\"figure\", {\n              className: \"image is-128x128\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: this.state.image,\n                onChange: this.handleChange,\n                alt: \"test\",\n                width: \"256\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 99,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"texts mcentered\",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"title\",\n              onChange: this.handleChange,\n              children: this.state.nickname\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"tags are-medium\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"tag\",\n                onChange: this.handleChange,\n                children: [\"#\", this.state.position]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 112,\n                columnNumber: 17\n              }, this), this.state.subjects.split(\", \").map((subject, index) => {\n                return /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"tag\",\n                  onChange: this.handleChange,\n                  children: [\"#\", subject]\n                }, index, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 117,\n                  columnNumber: 21\n                }, this);\n              })]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 111,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"button is-primary\",\n              href: \"\",\n              onClick: this.updateClick,\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"\\uD504\\uB85C\\uD544 \\uC218\\uC815\\uD558\\uAE30\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 142,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 137,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container mcentered\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profile-img\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-img\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"file has-name is-centered\",\n              children: /*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"file-label\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  className: \"file-input\",\n                  type: \"file\",\n                  name: \"image\",\n                  onChange: this.fileChangeHandler\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 163,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"file-cta\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"file-icon\",\n                    children: /*#__PURE__*/_jsxDEV(\"i\", {\n                      className: \"fas fa-upload\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 171,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 170,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"file-label\",\n                    children: \"Choose a file\\u2026\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 173,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 169,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"file-name\",\n                  children: this.state.image\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 175,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"texts mcentered\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"input is-primary is-medium\",\n              type: \"text\",\n              name: \"nickname\",\n              onChange: this.handleChange,\n              placeholder: this.state.nickname\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 180,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"input is-primary is-medium\",\n              type: \"text\",\n              name: \"position\",\n              onChange: this.handleChange,\n              placeholder: this.state.position\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"input is-primary is-medium\",\n              type: \"text\",\n              name: \"subjects\",\n              onChange: this.handleChange,\n              placeholder: this.state.subjects\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"button is-primary\",\n              href: \"\",\n              onClick: this.updateClick,\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"\\uC644\\uB8CC\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 206,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 201,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 9\n      }, this);\n    }\n  }\n\n}\n\nexport default _c = withRouter(Profile);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["C:/Users/User/Desktop/React-Board-master/newvenv/React-Board/src/pages/Profile.js"],"names":["React","Component","axios","Redirect","withRouter","Profile","constructor","props","state","isUpdate","nickname","position","subjects","image","new_image","handleChange","bind","fileChangeHandler","updateClick","getProfile","updateProfile","event","preventDefault","file","target","files","setState","prevState","name","value","token","localStorage","getItem","console","log","formData","FormData","append","entries","patch","headers","then","response","status","history","push","get","data","render","isLogin","split","map","subject","index"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport { Redirect, withRouter } from \"react-router-dom\";\r\n\r\nclass Profile extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      isUpdate: false,\r\n      nickname: \"\",\r\n      position: \"\",\r\n      subjects: \"\",\r\n      image: \"\",\r\n      new_image: null,\r\n    };\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.fileChangeHandler = this.fileChangeHandler.bind(this);\r\n    this.updateClick = this.updateClick.bind(this);\r\n    this.getProfile = this.getProfile.bind(this);\r\n    this.updateProfile = this.updateProfile.bind(this);\r\n    this.getProfile();\r\n  }\r\n  fileChangeHandler(event) {\r\n    event.preventDefault();\r\n    const file = event.target.files[0];\r\n    this.setState({\r\n      new_image: file,\r\n      image: file[\"name\"],\r\n    });\r\n  }\r\n  updateClick(event) {\r\n    event.preventDefault();\r\n    if (this.state.isUpdate === true) {\r\n      this.updateProfile();\r\n    } else {\r\n      this.setState((prevState) => ({ isUpdate: !prevState.isUpdate }));\r\n    }\r\n  }\r\n  handleChange(event) {\r\n    const target = event.target;\r\n    this.setState({\r\n      [target.name]: target.value,\r\n    });\r\n  }\r\n  updateProfile() {\r\n    const token = localStorage.getItem(\"token\");\r\n    console.log(\"[*] updateProfile\");\r\n    const formData = new FormData();\r\n    formData.append(\"image\", this.state.new_image);\r\n    formData.append(\"nickname\", this.state.nickname);\r\n    formData.append(\"position\", this.state.position);\r\n    formData.append(\"subjects\", this.state.subjects);\r\n    console.log(formData.entries());\r\n    axios\r\n      .patch(\"http://localhost:8000/users/profile/\", formData, {\r\n        headers: {\r\n          \"content-type\": \"multipart/form-data\",\r\n          \"Authorization\": `Token ${token}`,\r\n        },\r\n      })\r\n      .then((response) => {\r\n        if (response.status < 300) {\r\n          this.props.history.push(\"/\");\r\n        }\r\n      });\r\n  }\r\n  getProfile() {\r\n    const token = localStorage.getItem(\"token\");\r\n    console.log(\"[*] getProfile\");\r\n    axios\r\n      .get(\"http://localhost:8000/users/profile/\", {\r\n        headers: {\r\n          \"Authorization\": `Token ${token}`,\r\n        },\r\n      })\r\n      .then((response) => {\r\n        if (response.status < 300) {\r\n          this.setState({\r\n            nickname: response.data[\"nickname\"],\r\n            position: response.data[\"position\"],\r\n            subjects: response.data[\"subjects\"],\r\n            image: response.data[\"image\"],\r\n          });\r\n        }\r\n      });\r\n  }\r\n  render() {\r\n    const isLogin = this.props.isLogin;\r\n    const isUpdate = this.state.isUpdate;\r\n    if (isLogin === false) {\r\n      return <Redirect to=\"/login\" />;\r\n    }\r\n    if (isUpdate === false) {\r\n      return (\r\n        <div className=\"container mcentered\">\r\n          <div className=\"profile-img\">\r\n            <div className=\"profile-img\">\r\n              <figure className=\"image is-128x128\">\r\n                <img\r\n                  src={this.state.image}\r\n                  onChange={this.handleChange}\r\n                  alt=\"test\"\r\n                  width=\"256\"\r\n                />\r\n              </figure>\r\n            </div>\r\n            <div className=\"texts mcentered\">\r\n              <h1 className=\"title\" onChange={this.handleChange}>\r\n                {this.state.nickname}\r\n              </h1>\r\n              <div className=\"tags are-medium\">\r\n                <span className=\"tag\" onChange={this.handleChange}>\r\n                  #{this.state.position}\r\n                </span>\r\n                {this.state.subjects.split(\", \").map((subject, index) => {\r\n                  return (\r\n                    <span\r\n                      className=\"tag\"\r\n                      onChange={this.handleChange}\r\n                      key={index}\r\n                    >\r\n                      #{subject}\r\n                    </span>\r\n                  );\r\n                })}\r\n              </div>\r\n              {/* <div className=\"button is-primary\">\r\n                <Link\r\n                  to={{\r\n                    pathname: \"/profile/edit\",\r\n                    profile: this.state,\r\n                  }}\r\n                >\r\n                  <span>프로필 수정하기</span>\r\n                </Link>\r\n              </div> */}\r\n              <div\r\n                className=\"button is-primary\"\r\n                href=\"\"\r\n                onClick={this.updateClick}\r\n              >\r\n                <span>프로필 수정하기</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    } else {\r\n      return (\r\n        <div className=\"container mcentered\">\r\n          <div className=\"profile-img\">\r\n            <div className=\"profile-img\">\r\n              {/* <figure className=\"image is-128x128\">\r\n                <img\r\n                  src={this.state.image}\r\n                  onChange={this.handleChange}\r\n                  alt=\"test\"\r\n                  width=\"256\"\r\n                />\r\n              </figure> */}\r\n              <div className=\"file has-name is-centered\">\r\n                <label className=\"file-label\">\r\n                  <input\r\n                    className=\"file-input\"\r\n                    type=\"file\"\r\n                    name=\"image\"\r\n                    onChange={this.fileChangeHandler}\r\n                  />\r\n                  <span className=\"file-cta\">\r\n                    <span className=\"file-icon\">\r\n                      <i className=\"fas fa-upload\"></i>\r\n                    </span>\r\n                    <span className=\"file-label\">Choose a file…</span>\r\n                  </span>\r\n                  <span className=\"file-name\">{this.state.image}</span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n            <div className=\"texts mcentered\">\r\n              <input\r\n                className=\"input is-primary is-medium\"\r\n                type=\"text\"\r\n                name=\"nickname\"\r\n                onChange={this.handleChange}\r\n                placeholder={this.state.nickname}\r\n              />\r\n              <input\r\n                className=\"input is-primary is-medium\"\r\n                type=\"text\"\r\n                name=\"position\"\r\n                onChange={this.handleChange}\r\n                placeholder={this.state.position}\r\n              />\r\n              <input\r\n                className=\"input is-primary is-medium\"\r\n                type=\"text\"\r\n                name=\"subjects\"\r\n                onChange={this.handleChange}\r\n                placeholder={this.state.subjects}\r\n              />\r\n              <div\r\n                className=\"button is-primary\"\r\n                href=\"\"\r\n                onClick={this.updateClick}\r\n              >\r\n                <span>완료</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nexport default withRouter(Profile);\r\n"]},"metadata":{},"sourceType":"module"}